# CatGraph Data Format

## Overview

`CatGraph` (also referred to as `CatGraphNX` or `catgraph_tree` in code and filenames) is a structured JSON format designed to represent knowledge extracted from scientific texts, particularly focusing on chemical catalyst synthesis and testing. It models this information as a graph structure with nodes and edges.

The primary goals of this format are:

1.  **Standardization:** Provide a consistent way to represent complex synthesis pathways and testing results.
2.  **Machine Readability:** Enable automated processing, analysis, visualization (e.g., using graph databases like Neo4j), and conversion into other formats (e.g., text summaries, ML datasets).
3.  **Traceability:** Link extracted data back to the source text via `source_text` fields.

A complete CatGraph typically encompasses both synthesis and testing information, although these might be extracted or processed in separate stages before being combined. Processed outputs, like those generated by `extract_synthesis_trees.py`, often focus on the synthesis pathway for a *specific* target catalyst and include its associated testing data, usually under a root key like `"catgraph_tree"`.

## Data Schema

The CatGraph is represented as a JSON object containing lists of nodes and edges.

### Nodes

Nodes represent the core entities: chemicals, synthesis steps, and testing experiments. Each node must have a unique `id` and a `type`.

#### 1. `type: "chemical"`

Represents a chemical substance involved in the process.

*   **`id`** (String, Required): Unique machine-friendly identifier.
    *   *Convention:* `chem_` prefix + canonical formula (e.g., `chem_TiO2`) or snake-case name (e.g., `chem_toluene`). Intermediate materials might have state tags appended (e.g., `chem_S1_dried`).
*   **`name`** (String, Required): Primary human-readable name exactly as found in the source text.
*   **`aliases`** (List[String], Optional): Alternative names, formulas, or abbreviations used for the same chemical in the text.
    **`formula`** (String, Optional): If the chemical entity is a substance/element can be expressed with chemical formular, or a solution with only one chemical, write down its formula here.
*   **`composition`** (Object, Optional): Describes the chemical makeup, especially for mixtures or doped materials.
    *   *Structure:* Keys are component names (e.g., "Pt", "Al2O3"), values are objects: `{"value": <number|string>, "unit": "<string>"}` (e.g., `{"Pt": {"value": 0.4, "unit": "wt%"}}`).
*   **`properties`** (Object, Optional but Recommended): Intrinsic physical or chemical properties reported in the text (e.g., surface area, particle size, pore volume).
    *   *Structure:* Keys are property names (full names preferred, e.g., "Brunauer-Emmett-Teller surface area"), values follow the `{"value": <number|string>, "unit": "<string>"}` structure (e.g., `{"surface_area": {"value": 152, "unit": "m2/g"}}`). Units should be included; use descriptive strings like "molar ratio" if dimensionless.
*   **`is_tested_catalyst`** (Boolean, Optional): Flag added during processing to indicate if this chemical was subsequently used in a testing experiment described in the text or has a reported tested result metric.

#### 2. `type: "synthesis"`

Represents a distinct step or action in the synthesis pathway.

*   **`id`** (String, Required): Unique identifier.
    *   *Convention:* `synth_step_` prefix + chronological number (e.g., `synth_step_1`).
*   **`name`** (String, Required): A brief, human-readable label for the step (e.g., "Calcination", "Impregnation").
*   **`procedure`** (String, Required): Verbatim sentence(s) from the source text describing only this step's actions.
*   **`method`** (String, Required): Simple and precise words (Try to make it less than 5 words) describing the synthesis method used in the synthesis step. 
*   **`conditions`** (Object, Optional): Dictionary of experimental conditions applied during this step.
    *   *Structure:* Keys are condition types (e.g., `temperature`, `time`, `pressure`, `atmosphere`, `pH`), values follow the `{"value": <number|string>, "unit": "<string>"}` structure.
*   **`source_text`** (String, Required): Verbatim quote from the source text anchoring this step, used for verification.
*   **`synthesis_level`** (Integer, Optional): Added by processing scripts (`extract_synthesis_trees.py`). Indicates the step's topological level in the synthesis Directed Acyclic Graph (DAG), starting from inputs.

#### 3. `type: "testing"`

Represents a specific catalyst testing experiment or scenario.

*   **`id`** (String, Required): Unique identifier.
    *   *Convention:* `test_` prefix + number (e.g., `test_1`).
*   **`catalyst_id`** (String, Required): The `id` of the `chemical` node being evaluated in *this* specific test.
*   **`description`** (String, Required): Brief summary of the test's objective or key condition (e.g., "CO oxidation performance evaluation").
*   **`conditions_json`** (Object, Required): Comprehensive dictionary of ALL experimental conditions for the test.
    *   *Structure:* Keys are condition names (e.g., `temperature`, `pressure`, `feed_composition`, `WHSV`), values follow the `{"value": <number|string>, "unit": "<string>"}` structure.
*   **`results_json`** (Object, Required): Comprehensive dictionary of ALL performance results reported for the test.
    *   *Structure:* Keys are result metrics (e.g., `conversion`, `selectivity`, `yield`, `stability`), values follow the `{"value": <number|string>, "unit": "<string>"}` structure.
*   **`source_text`** (String, Required): Verbatim quote from the source text detailing the test setup and results.

### Edges

Edges define the relationships between nodes, representing material flow, process sequence, or testing application. Each edge must have a unique `id`, `type`, `source_id`, and `target_id`.

#### 1. `type: "synthesis_input"`

Connects a `chemical` node to a `synthesis` node, indicating the chemical is consumed or used in that step.

*   **`id`** (String, Required): Unique identifier.
    *   *Convention:* `edge_input_<chem_id>_<synth_id>`.
*   **`source_id`** (String, Required): `id` of the input `chemical` node.
*   **`target_id`** (String, Required): `id` of the `synthesis` node.
*   **`properties`** (Object, Optional): Provides context about the input's role or quantity.
    *   *Example Keys:* `role` (e.g., "reactant", "solvent", "catalyst", "support", "precursor"), `amount` (using `{"value": ..., "unit": ...}`), `concentration`.

#### 2. `type: "synthesis_output"`

Connects a `synthesis` node to a `chemical` node, indicating the chemical is produced or results from that step.

*   **`id`** (String, Required): Unique identifier.
    *   *Convention:* `edge_output_<synth_id>_<chem_id>`.
*   **`source_id`** (String, Required): `id` of the `synthesis` node.
*   **`target_id`** (String, Required): `id` of the output `chemical` node. (Note: To ensure a DAG, this `chemical` node often represents a new state of a material, e.g., `chem_S1_dried` resulting from a drying step on `chem_S1_paste`).
*   **`properties`** (Object, Optional): Provides context about the output.
    *   *Example Keys:* `form` (e.g., "precipitate", "calcined solid", "solution"), `yield`, `purity`.

#### 3. `type: "tested_in"`

Connects a `chemical` node (specifically, a catalyst) to a `testing` node where it was evaluated.

*   **`id`** (String, Required): Unique identifier.
    *   *Convention:* `edge_tested_<chem_id>_<test_id>`.
*   **`source_id`** (String, Required): `id` of the `chemical` node (catalyst).
*   **`target_id`** (String, Required): `id` of the `testing` node.
*   **`properties`** (Object, Optional): Can contain details specific to this test instance, such as catalyst amount used in the test *if* distinct from general properties, or test-specific pre-treatment information.

### Other Top-Level Fields

Depending on the stage of processing, other fields might exist at the top level:

*   **`catalyst_id`** (String): Often present in processed `catgraph_tree` files, indicating the primary catalyst this specific subgraph pertains to.
*   **`catalyst_tested_ids`** (List[String]): Found in the initial *synthesis* graph extraction output. It lists the `id`s of `chemical` nodes that were identified in the text as being used for subsequent testing. This list helps link the synthesis and testing phases. 